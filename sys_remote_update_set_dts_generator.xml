<?xml version="1.0" encoding="UTF-8"?>
<unload unload_date="2017-02-16 20:17:15">
<sys_remote_update_set action="INSERT_OR_UPDATE">
<application display_value="Global">global</application>
<application_name>Global</application_name>
<application_scope>global</application_scope>
<application_version/>
<collisions/>
<commit_date/>
<deleted/>
<description/>
<inserted/>
<name>Type Definition Generator</name>
<origin_sys_id/>
<release_date/>
<remote_sys_id>00f02354db8d320016255c00cf961994</remote_sys_id>
<state>loaded</state>
<summary/>
<sys_class_name>sys_remote_update_set</sys_class_name>
<sys_created_by>type.definition</sys_created_by>
<sys_created_on>2017-02-16 20:17:14</sys_created_on>
<sys_id>03ac2128dbcd320016255c00cf961961</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_updated_by>type.definition</sys_updated_by>
<sys_updated_on>2017-02-16 20:17:14</sys_updated_on>
<update_set display_value=""/>
<update_source display_value=""/>
<updated/>
</sys_remote_update_set>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_ws_definition_45c9df90db8d320016255c00cf9619a8</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_ws_definition"><sys_ws_definition action="INSERT_OR_UPDATE"><active>true</active><base_uri>/api/79030/type_definition</base_uri><consumes>application/octet-stream</consumes><consumes_customized>true</consumes_customized><default_version>No active default version</default_version><doc_link/><enforce_acl/><is_versioned>false</is_versioned><name>Generate TypeScript Definition files</name><namespace>79030</namespace><produces>application/octet-stream</produces><produces_customized>true</produces_customized><service_id>type_definition</service_id><short_description/><sys_class_name>sys_ws_definition</sys_class_name><sys_created_by>type.definition</sys_created_by><sys_created_on>2017-02-16 09:35:48</sys_created_on><sys_customer_update>true</sys_customer_update><sys_id>45c9df90db8d320016255c00cf9619a8</sys_id><sys_mod_count>9</sys_mod_count><sys_name>Generate TypeScript Definition files</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_replace_on_upgrade>false</sys_replace_on_upgrade><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_ws_definition_45c9df90db8d320016255c00cf9619a8</sys_update_name><sys_updated_by>type.definition</sys_updated_by><sys_updated_on>2017-02-16 10:15:10</sys_updated_on></sys_ws_definition></record_update>]]></payload>
<remote_update_set display_value="Type Definition Generator">03ac2128dbcd320016255c00cf961961</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>type.definition</sys_created_by>
<sys_created_on>2017-02-16 20:17:14</sys_created_on>
<sys_id>83ac2128dbcd320016255c00cf961961</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_updated_by>type.definition</sys_updated_by>
<sys_updated_on>2017-02-16 20:17:14</sys_updated_on>
<table/>
<target_name>Generate TypeScript Definition files</target_name>
<type>Scripted REST API</type>
<update_domain>global</update_domain>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_ws_operation_450a53d0db8d320016255c00cf96190e</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="sys_ws_operation"&gt;&lt;sys_ws_operation action="INSERT_OR_UPDATE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;consumes&gt;application/octet-stream&lt;/consumes&gt;&lt;consumes_customized&gt;false&lt;/consumes_customized&gt;&lt;default_operation_uri/&gt;&lt;enforce_acl/&gt;&lt;http_method&gt;GET&lt;/http_method&gt;&lt;name&gt;generate GlideRecord d.ts&lt;/name&gt;&lt;operation_script&gt;&lt;![CDATA[(function process( /*RESTAPIRequest*/ request, /*RESTAPIResponse*/ response) {

    var snakeToCamel = function(string, capitalized) {
        var retVal = string.replace(/(\_\w)/g, function(m) { return m[1].toUpperCase(); });
        if (capitalized) retVal = retVal.charAt(0).toUpperCase() + retVal.slice(1);
        return retVal;
    };

    // refer to table 'sys_glide_object' for a list of all datatypes
    // JS/TS Scalar Types: boolean, number, string, any, (void, null, undefined)
    var getNativeDatatype = function(glideElement) {
        //TODO-MESC: implement logic for conversion of SNOW datatypes to JS/TS Scalar Types
        return glideElement.getInternalType();
    };

    var table_name = request.pathParams.table_name;
    var interfaceName = 'I' + snakeToCamel(table_name, true);

    var contentArr = [];
    var tableGr = new GlideRecord(table_name);
    tableGr.setLimit(1);
    tableGr.query();
    tableGr.next();

    var fields = tableGr.getFields();

    contentArr = contentArr.concat(
        'declare module sn {',
        '   export module Server {',
        '       export interface IGlideServerRecord {',
        '           new (type: \'' + request.pathParams.table_name + '\'): sn.Types.' + interfaceName + ';',
        '       }',
        '   }',
        '',
        '   export module Types {',
        '       export interface ' + interfaceName + ' extends sn.Server.IGlideServerRecord {'
    );

    for (var i = 0; i &lt; fields.size(); i++) {
        var glideElement = fields.get(i);
        var elementDescriptor = glideElement.getED();
        contentArr = contentArr.concat('           ' + glideElement.getName() + ': ' + getNativeDatatype(elementDescriptor) + '; //' + elementDescriptor.getInternalType() + ' (' + elementDescriptor.getLength() + ')');
    }

    contentArr = contentArr.concat(
        '       }',
        '   }',
        '}'
    );

    // return contentArr.join('\n'); //UNCOMMENT FOR DEBUGGING

    var headers = {
        "Content-Description": "File Transfer",
        "Content-Type": "application/octet-stream",
        "Content-Disposition": "attachment; filename=" + table_name + ".d.ts",
        "Content-Transfer-Encoding": "binary"
    }

    response.setStatus(200);
    response.setHeaders(headers);

    var writer = response.getStreamWriter();
    writer.writeString(contentArr.join("\n"));


})(request, response);]]&gt;&lt;/operation_script&gt;&lt;operation_uri&gt;/api/79030/type_definition/glide_record/{table_name}&lt;/operation_uri&gt;&lt;produces&gt;application/octet-stream&lt;/produces&gt;&lt;produces_customized&gt;false&lt;/produces_customized&gt;&lt;relative_path&gt;/glide_record/{table_name}&lt;/relative_path&gt;&lt;request_example/&gt;&lt;requires_acl_authorization&gt;false&lt;/requires_acl_authorization&gt;&lt;requires_authentication&gt;true&lt;/requires_authentication&gt;&lt;short_description&gt;generates a Typescript definition for a specified table name&lt;/short_description&gt;&lt;sys_class_name&gt;sys_ws_operation&lt;/sys_class_name&gt;&lt;sys_created_by&gt;type.definition&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2017-02-16 09:37:58&lt;/sys_created_on&gt;&lt;sys_customer_update&gt;true&lt;/sys_customer_update&gt;&lt;sys_id&gt;450a53d0db8d320016255c00cf96190e&lt;/sys_id&gt;&lt;sys_mod_count&gt;83&lt;/sys_mod_count&gt;&lt;sys_name&gt;generate GlideRecord d.ts&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_replace_on_upgrade&gt;false&lt;/sys_replace_on_upgrade&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;sys_ws_operation_450a53d0db8d320016255c00cf96190e&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;type.definition&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2017-02-16 15:14:04&lt;/sys_updated_on&gt;&lt;web_service_definition display_value="Generate TypeScript Definition files"&gt;45c9df90db8d320016255c00cf9619a8&lt;/web_service_definition&gt;&lt;web_service_version/&gt;&lt;/sys_ws_operation&gt;&lt;/record_update&gt;</payload>
<remote_update_set display_value="Type Definition Generator">03ac2128dbcd320016255c00cf961961</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>type.definition</sys_created_by>
<sys_created_on>2017-02-16 20:17:14</sys_created_on>
<sys_id>c3ac2128dbcd320016255c00cf961961</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_updated_by>type.definition</sys_updated_by>
<sys_updated_on>2017-02-16 20:17:14</sys_updated_on>
<table/>
<target_name>generate GlideRecord d.ts</target_name>
<type>Scripted REST Resource</type>
<update_domain>global</update_domain>
<update_set display_value=""/>
<view/>
</sys_update_xml>
</unload>
